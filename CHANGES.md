CHANGES — SmartTheme localization sweep

2025-11-02

- Localized all user-facing log strings in `SmartTheme.ps1`.
  - Replaced literal Write-Log messages with `Write-Log (Translate 'KEY' <args>)` calls.
  - Keys used include: SCRIPT_RUNNING, THEME_SWITCHED_DARK, THEME_SWITCHED_LIGHT, SCHEDULE_ADJUSTED_ADD_DAY, NON_ELEVATED_ATTEMPT, SCHEDULED_USER_ENSURE, SCHEDULE_USER_ONCE_FAILED, SCHTASKS_USER, SCHTASKS_USER_STARTUP, SCHTASKS_USER_LOGON, NON_ELEVATED_ERROR, SCHEDULE_XML_SCHEDULED, IMPORT_XML_FAILED, SCHEDULED_API, SCHEDULE_SETTINGS_INFO, SCHEDULE_API_FAILED, SCHTASKS_OUT, SCHTASKS_SCHEDULED, SCHTASKS_FALLBACK_NOTE, SCHTASKS_EXITCODE, SCHTASKS_STARTUP_OUT, SCHTASKS_LOGON_OUT, SCHEDULE_ERROR, EXPORT_TASK, EXPORT_TASK_DONE, EXPORT_TASK_FAIL, XML_CREATED, XML_CREATE_FAIL, IMPORTING_XML, SCHTASKS_IMPORT, IMPORT_XML_DONE, IMPORT_XML_ERROR, RETRY_WAIT, GET_LOCATION, USED_MANUAL_COORDS, LOCATION_INFO, SAVE_CACHE_FAIL, IPAPI_FAIL, USED_CACHE, NO_LOCATION_FALLBACK_USING_LOC, NO_LOCATION_FALLBACK_HARD, GET_SUN_TIMES, CALL_API_URL, API_STATUS, PARSE_SUN_WARN, UTC_SUNRISE, UTC_SUNSET, USING_WINDOWS_TZ, TZ_MAP_WARN, EVENTS_PASSED, CALL_API_NEXTDAY, NEW_LOCAL_TIMES, CANNOT_GET_NEXTDAY, ERROR_QUERY_NEXTDAY, CANNOT_SAVE_SUN_CACHE, LOCAL_SUNRISE, LOCAL_SUNSET, SUN_API_FAIL, USING_CACHED_SUN, CACHE_STILL_PAST, RETRY_SCHEDULED, RETRY_SCHEDULE_FAIL, USING_CACHED_SHIFTED, CACHE_USE_ERROR, CACHE_FETCH_ERROR, NO_SUITABLE_CACHE, SCHEDULE_ONLY, CANNOT_DETERMINE_CURRENT_THEME, CURRENT_TO_TARGET, SCHEDULE_MODE_NO_CHANGE, SUNSET_STILL_PAST, SUNRISE_STILL_PAST, SCHEDULED_DONE, SCHEDULE_FAILED_GENERIC, ELEVATED_INSTRUCTIONS, ELEVATED_CMD, SCHTASKS_EXAMPLE_CMD, SCHTASKS_EXAMPLE_CMD_LINE, RUN_ELEVATED_SUGGEST

- Fixed `lib/Localization.ps1` Translate() formatting to correctly use PowerShell `-f` and added a fallback when formatting fails.

- Added/updated Pester tests:
  - `tests/Localization.Tests.ps1` — unit tests for locale loading, Translate formatting, and key symmetry across `en.json`, `cs.json`, `de.json`.
  - `tests/Smoke.Tests.ps1` — (see below) smoke test to validate runtime localized logs from Set-Theme in a mocked environment.

Notes:
- Behavior unchanged except for localization of log text and the Translate() formatting fix.
- Tests were executed locally and passed (7 passing at time of change) — see test output for details.
