# Release v2026-01-27

Summary
- Fixes: resolved scheduler quoting and `Write-Log` errors, fixed dot-sourcing bug in `SmartTheme.ps1`.
- Reliability: Pester tests (15/15) and PSScriptAnalyzer pass; added `tools/add-path.ps1` to append SmartTheme to user PATH.
- UX: added `theme.cmd` shim so `theme` works across shells; improved scheduler fallback to use ScheduledTasks API when available.

Files changed
- lib/SmartThemeModule.psm1: scheduler quoting fixes, improved non-elevated task registration, logging improvements.
- lib/Scheduler.psm1: safer `/TR` quoting for `schtasks` fallback.
- lib/LoggingModule.psm1: added `Write-Log` compatibility wrapper.
- SmartTheme.ps1: fixed dot-sourcing and import ordering.
- tools/add-path.ps1: helper to append SmartTheme folder to user PATH.

Notes
- After updating, open a new terminal to use the `theme` shim. To run the script elevated for system-level scheduling, use the Start-Process example printed by the script.
# Release v2026-01-27

Date: 2026-01-27

Summary
- Tests and CI: fixed Pester tests and updated mocks to use approved verbs and reference unused parameters so `PSScriptAnalyzer` reports no findings.
- Tools: added `tools/run-local-checks.ps1` to run pinned Pester (v3.4) and `PSScriptAnalyzer` locally.
- Logging & localization: improved UTF-8/BOM handling and added automatic log trimming to reduce repository noise.
- Refactors: small changes across `lib/` to improve DI (`-Config`) and add `ShouldProcess` to state-changing functions.

Notes
- Tag: `v2026-01-27` (annotated tag pushed to origin).
- To publish a GitHub Release from this tag locally, use the GitHub CLI:

```powershell
gh release create v2026-01-27 --title "v2026-01-27" --notes-file RELEASES/v2026-01-27.md
```
